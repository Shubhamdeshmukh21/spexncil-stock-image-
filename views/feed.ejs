<%- include('partials/header') %>

<div class="w-full px-2 sm:px-4 md:px-6 py-6 bg-zinc-800 min-h-screen text-white">
  <!-- Responsive Masonry Layout with compact cards -->
  <div class="columns-2 xs:columns-2 sm:columns-3 md:columns-4 lg:columns-5 gap-3 sm:gap-4">

    <% posts.forEach(post => { %>
      <a href="/post/<%= post._id %>"
         class="inline-block w-full mb-4 bg-zinc-900 rounded-xl overflow-hidden shadow-md hover:scale-[1.01] transition-transform duration-200 break-inside-avoid">

        <% if (post.image && post.image.data) { %>
          <img
            src="data:<%= post.image.contentType %>;base64,<%= post.image.data.toString('base64') %>"
            alt="<%= post.title %>"
            class="w-full h-auto object-cover"
            loading="lazy"
          />
        <% } else { %>
          <div class="w-full h-32 bg-zinc-700 flex items-center justify-center text-white text-sm">No image</div>
        <% } %>

        <div class="p-2 sm:p-3">
          <h3 class="text-sm sm:text-base font-semibold mb-1"><%= post.title %></h3>
          <p class="text-xs sm:text-sm text-zinc-400">By @<%= post.user.username %></p>
        </div>
      </a>
    <% }) %>

  </div>
</div>

<%- include('partials/footer') %>
